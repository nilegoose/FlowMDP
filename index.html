<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Sankey Demo</title>
<style>
 
.container {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  grid-gap: 10px;
  justify-content: center;
  align-items: center;
  box-sizing: border-box;

}
   
#chart {
  height: 500px;
}
 
.node rect {
  cursor: move;
  fill-opacity: .9;
  shape-rendering: crispEdges;
}
 
.node text {
  pointer-events: none;
  text-shadow: 0 1px 0 #fff;
}
 
.link {
  fill: none;
  stroke: #000;
  stroke-opacity: .2;
}
 
.link:hover {
  stroke-opacity: .6 !important;
}


.color-box {
      width: 100px;
      height: 100px;
      display: inline-block;
      margin: 10px;
      transition: opacity 0.3s ease-in-out;
      opacity : 0.5;
      text-align: center;
      border-radius: 10px;


    }



 
</style>
<link rel = "stylesheet" href="nav.css">
</head>
<body>


  
  
  <div id="main">


    <!--the first row-->
  <div class = "flex_box">
    <h2>Sankey Diagram</h2>
    <span class="tab"></span>
    <svg id="reset_icon" xmlns="http://www.w3.org/2000/svg" height="30" viewBox="0 -960 960 960" width="30" fill="green">
      <path d="M451-122q-123-10-207-101t-84-216q0-77 35.5-145T295-695l43 43q-56 33-87 90.5T220-439q0 100 66 173t165 84v60Zm60 0v-60q100-12 165-84.5T741-439q0-109-75.5-184.5T481-699h-20l60 60-43 43-133-133 133-133 43 43-60 60h20q134 0 227 93.5T801-439q0 125-83.5 216T511-122Z"/>
    </svg>
    <span class="tab"></span>
    <div class="dropdown">
    <svg class="dropbtn" id="setting_icon" xmlns="http://www.w3.org/2000/svg" height="30" viewBox="0 -960 960 960" width="30">
        <path d="M226-160q-28 0-47-19t-19-47q0-28 19-47t47-19q28 0 47 19t19 47q0 28-19 47t-47 19Zm254 0q-28 0-47-19t-19-47q0-28 19-47t47-19q28 0 47 19t19 47q0 28-19 47t-47 19Zm254 0q-28 0-47-19t-19-47q0-28 19-47t47-19q28 0 47 19t19 47q0 28-19 47t-47 19ZM226-414q-28 0-47-19t-19-47q0-28 19-47t47-19q28 0 47 19t19 47q0 28-19 47t-47 19Zm254 0q-28 0-47-19t-19-47q0-28 19-47t47-19q28 0 47 19t19 47q0 28-19 47t-47 19Zm254 0q-28 0-47-19t-19-47q0-28 19-47t47-19q28 0 47 19t19 47q0 28-19 47t-47 19ZM226-668q-28 0-47-19t-19-47q0-28 19-47t47-19q28 0 47 19t19 47q0 28-19 47t-47 19Zm254 0q-28 0-47-19t-19-47q0-28 19-47t47-19q28 0 47 19t19 47q0 28-19 47t-47 19Zm254 0q-28 0-47-19t-19-47q0-28 19-47t47-19q28 0 47 19t19 47q0 28-19 47t-47 19Z"/>
    </svg>
<!--drop down-->
    <div class="dropdown-content">
      <details>
        <summary>Search Charts by Functions</summary>
        <p>    <span class="tab"></span>
          Single click on color box to search, double click to cancel.</p>
        <p></p>
        <p>    <b>Functions:</b></p>
          <ul>
            <li>comparision</li>
            <li>relationships</li>
          </ul>
      </details>
      <div class="container">
      <div class="color-box" id="fun_compa" style="background-color: #5ab4ac;"><p>comparision</p></div>
      <!-- A4 + B1-->
      <div class="color-box" id="fun_rel" style="background-color: #d8b365;"><p>relationships</p></div>
      </div>
    </div>
<!-- end drop down-->
    
  
  </div>
    <span class="tab"></span>
    <svg xmlns="http://www.w3.org/2000/svg" height="30" viewBox="0 -960 960 960" width="30" class="end-element" id="print-icon">
      <path d="M658-648v-132H302v132h-60v-192h476v192h-60Zm-518 60h680-680Zm599 95q12 0 21-9t9-21q0-12-9-21t-21-9q-12 0-21 9t-9 21q0 12 9 21t21 9Zm-81 313v-192H302v192h356Zm60 60H242v-176H80v-246q0-45.05 30.5-75.525Q141-648 186-648h588q45.05 0 75.525 30.475Q880-587.05 880-542v246H718v176Zm102-236v-186.215Q820-562 806.775-575 793.55-588 774-588H186q-19.55 0-32.775 13.225Q140-561.55 140-542v186h102v-76h476v76h102Z"/>
    </svg>


  </div>

<!--end flex box-->


    <div id="chart">

    </div>

    <div class="text-row">
      <p id="button1">1</p>
      <p id="button2">1</p>
      <p id="button3">1</p>
      <p id="button4">1</p>

      <!--p id="button2" class="textButton">2</p>
      <p id="button3" class="textButton">3</p>
      <p id="button4" class="textButton">4</p-->
    </div> 


    <br>
    <div id = "text-area1">
      <p>chose node:</p>
      <p id="text1"></p>
      <p>encoding:</p>
      <p id="text2"></p>
      <div id="radioContainer"></div>
    <div id="multiple"></div>

    </div>  
  </div>
</body>

  
  
  
  <script src="nav.js"></script>>    




<!--script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
  <script src="http://d3js.org/d3.v3.min.js?2.9.1"></script-->
<script src="lib/ajax.js"></script>
<script src="lib/d3v3.js"></script>

<script src="sankey.js"></script>
<script src="bubble2.js"></script>
<script src="getdata.js"></script>
<script src="click_events.js"></script>
<script src="util.js"></script>
<script src="util_graph.js"></script>
<script src="anonymous.js"></script>
<script src="data.js"></script>

<script>

  //legnth of four column is currently 4, 9, 30, 8
  // [0-3, 4-12, 13-42, 43-50]
var highlighted_link = [];
var link_toHighlight = [];
var link_count;
var opacity_pick;
var dataObj = DataObj.getData();


  
var margin = {top: 10, right: 50, bottom: 100, left: 50},
    width = window.innerWidth - margin.left - margin.right - 20,
    height = window.innerHeight - margin.top - margin.bottom -110;

var formatNumber = d3.format(",.0f"),
    format = function(d) { return formatNumber(d) + "  "; };
    
  var svg = d3.select("#chart").append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
    .attr("id", "chartSVG")
    .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");



function updateSankey() {

  drawSankey(data_process2(), svg);

}



drawSankey(dataObj.getData(), svg);

function resetSankey() {

  drawSankey(dataObj.getData(), svg);

}


var resetBtn = document.getElementById("reset_icon");
resetBtn.addEventListener("click", resetSankey);



 
 // step : try to modify node with

  //node.exit().remove();

//draw(getData());


function changeColor(){
  d3.selectAll("rect")
    .transition()
    .duration(500)
    .style("fill", "red")
}

function changeWidth(width){
  d3.selectAll("rect")
    .transition()
    .duration(2000)
    .style("width", width)
}
 
  
  function showText(text){
    //$("#text p").text("what")
    var para = document.getElementById("text1").innerHTML=text;
   // d3.select("textarea").node().value = local.get(thisCircle) || "";
  //d3.select("button").on("click", function() {
   //   local.set(thisCircle, d3.select("textarea").node().value);
  }


  function showText2(text){
    //$("#text p").text("what")
    var para = document.getElementById("text2").innerHTML=text;
   // d3.select("textarea").node().value = local.get(thisCircle) || "";
  //d3.select("button").on("click", function() {
   //   local.set(thisCircle, d3.select("textarea").node().value);
  }

  // the function creates radio button from a list

  function updateEncoding(e_list, id, btnId, radioName){
    var container = document.getElementById(id);

// Create the radio group
  e_list.forEach(function(option) {
  // Create the radio button element
  var radioBtn = document.createElement("input");
  radioBtn.type = "radio";
  radioBtn.name = radioName; // Give it a unique name
  radioBtn.value = option; // Set the value of the radio button

  // Create a label for the radio button
  var label = document.createElement("label");
  label.innerHTML = option;

  // Append the radio button and label to the container
  container.appendChild(radioBtn);
  container.appendChild(label);
  container.appendChild(document.createElement("br")); // Add a line break

// Append the submit button to the container
});
createBtn(container, btnId, radioName)
}
  function createBtn(container, btnId ,radioName){
  var submitBtn = document.createElement("input");
  submitBtn.type = "submit";
  submitBtn.value = "Submit";
  submitBtn.id = btnId;
  submitBtn.addEventListener("click", function() {
  // Get the selected radio button
  var selectedOption = document.querySelector(`input[name="${radioName}"]:checked`);

  // Check if any option is selected
  if (selectedOption) {
    //size/area
    var selectedValue = selectedOption.value;
    console.log("Selected value: " + selectedValue);
    if (selectedValue.includes('color')) {

      draw(true, false);
    } else {
    draw(false, false);
    } 

  }});
  container.appendChild(submitBtn);


  }
  //draw(true);
  
  //draw(true);

  </script>


